#!/bin/sh

# Script to send a crash bug report to me.

LIB=lib

if [ ! -d $LIB ]; then
	LIB=../lib
	if [ ! -d $LIB ]; then
		echo 'Cannot find lib directory.'
		exit 1
	fi
fi

(
echo 'JeamLand crash bug report - generated by mailbug'
date
echo '------------------------------------------------'
if [ -f $LIB/log/backtrace ]; then
	echo '--> Backtrace <--'
	tail -30 $LIB/log/backtrace
	echo
fi
if [ -f $LIB/log/fatal ]; then
	echo '--> Fatal <--'
	tail -10 $LIB/log/fatal
	echo
fi
if [ -f $LIB/log/error ]; then
	echo '--> Error <--'
	tail -10 $LIB/log/error
	echo
fi
if [ -f $LIB/log/syslog ]; then
	echo '--> Syslog <--'
	tail -50 $LIB/log/syslog
	echo
fi
if [ -f $LIB/../src/jeamland ]; then
	echo '--> Binary symbols <--'
	nm $LIB/../src/jeamland
	echo
fi
) | mail -s'Mailbug crash report' jeamland@twikki.demon.co.uk

